<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ApartHotel Snow</title>
    <link rel="shortcut icon" href="img/icono.png" type="img/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- css link -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>


    <!-- header  -->
    <header class="header">

        <a href="index.html" class="logo"> <i class="fas fa-snowflake"></i> ApartHotel Snow</a>

        <nav class="navbar">
            <a href="index.html">Inicio</a>
            <a href="nosotros.html">Sobre Nosotros</a>
            <a href="servicios.html">Servicios</a>
            <a href="menu.html">Menu</a>
            <a href="opiniones.html">Testimonios</a>
        </nav>

        <div class="icons">
            <div class="fas fa-user" id="login-btn"></div>
            <div class="fas fa-bars" id="menu-btn"></div>
        </div>

        <form class="login-form">

            <h3>formulario login</h3>

            <input type="email" placeholder="ingrese su email" class="box">
            <input type="password" placeholder="ingrese su password" class="box">
            <div class="remember">
                <input type="checkbox">
                <label>Recordarme</label>
            </div>
            <a href="index.html" class="btn">logueate ahora</a>

        </form>

    </header>
    <br><br><br><br><br>

    <main>
        <section class="home" id="home">
            <div class="listar-section">

                <!--fin header -->
                <table> <!-- Se crea una tabla para mostrar las reservas -->
                    <thead>
                        <!--Encabezado de la tabla con columnas para código, descripción, cantidad, precio y acciones.-->
                        <tr>
                            <th>Reserva</th>
                            <th>Habitación</th>
                            <th>Cliente</th>
                            <th>Niños</th>
                            <th>Adultos</th>
                            <th>Fecha Ingreso</th>
                            <th>Fecha Egreso</th>
                            <th>QR</th>

                        </tr>
                    </thead>
                    <tbody id="tablaReservas"> </tbody>
                </table><br>

                <div class="a-table">
                    <a href="reservas.html">Volver a Reservas</a>
                </div>

                <script>
                    // const URL = "http://127.0.0.1:5000/"
                    const URL = "https://ggindelli.pythonanywhere.com/"

                    
                   


                    // Al subir al servidor, deberá utilizarse la siguiente ruta. USUARIO debe ser reemplazado por el nombre de usuario de Pythonanywhere
                    //const URL = "https://USUARIO.pythonanywhere.com/"


                    // Realizamos la solicitud GET al servidor para obtener todos los productos.
                    fetch(URL + 'reservas')
                        .then(function (response) {
                            if (response.ok) {
                                //Si la respuesta es exitosa (response.ok), convierte el cuerpo de la respuesta de formato JSON a un objeto JavaScript y pasa estos datos a la siguiente promesa then.
                                return response.json();
                            } else {
                                // Si hubo un error, lanzar explícitamente una excepción para ser "catcheada" más adelante
                                throw new Error('Error al obtener las reservas.');
                            }
                        })

                        //Esta función maneja los datos convertidos del JSON.
                        .then(function (data) {
                            let tablaReservas = document.getElementById('tablaReservas'); //Selecciona el elemento del DOM donde se mostrarán los productos.

                            // Iteramos sobre cada producto y agregamos filas a la tabla
                            for (let reserva of data) {
                                let fila = document.createElement('tr'); //Crea una nueva fila de tabla (<tr>) para cada producto.
                                fila.innerHTML = '<td>' + reserva.nro_reserva + '</td>' +
                                    '<td>' + reserva.nro_habitacion + '</td>' +
                                    '<td>' + reserva.nro_cliente + '</td>' +
                                    '<td>' + reserva.cant_ninios + '</td>' +
                                    '<td>' + reserva.cant_adultos + '</td>' +
                                    '<td>' + reserva.fecha_ingreso + '</td>' +
                                    '<td>' + reserva.fecha_egreso + '</td>' +
                                    //no le gusta mi ruta al codigo qr...
                                    // '<td><img src=./img/' + reserva.reserva_qr + ' alt="QR Reserva" style="width: 100px;"></td>'
                                    '<td><img src=https://www.pythonanywhere.com/user/ggindelli/files/home/ggindelli/mysite/img/' + reserva.reserva_qr + ' alt="QR Reserva" style="width: 100px;"></td>'

                                //Al subir al servidor, deberá utilizarse la siguiente ruta. USUARIO debe ser reemplazado por el nombre de usuario de Pythonanywhere
                                //'<td><img src=https://www.pythonanywhere.com/user/USUARIO/files/home/USUARIO/mysite/static/imagenes/' + producto.imagen_url +' alt="Imagen del producto" style="width: 100px;"></td>' + '<td align="right">' + producto.proveedor + '</td>';

                                //Una vez que se crea la fila con el contenido del producto, se agrega a la tabla utilizando el método appendChild del elemento tablaProductos.
                                tablaReservas.appendChild(fila);
                            }
                        })

                        //Captura y maneja errores, mostrando una alerta en caso de error al obtener los productos.
                        .catch(function (error) {
                            // Código para manejar errores
                            alert('Error al obtener las reservas.');
                        });
                </script>
            </div>

        </section>

    </main>
    <footer>

        <!-- footer -->

        <section class="footer">

            <div class="box-container">

                <div class="box">
                    <h3><i class="fas fa-snowflake"></i> ApartHotel Snow</h3>
                    <p>❄️Tu lugar en el Mundo.</p>
                    <div class="share">
                        <a href="https://www.facebook.com" target="_blank" class="fab fa-facebook-f"></a>
                        <a href="https://www.twitter.com" target="_blank" class="fab fa-twitter"></a>
                        <a href="https://www.instagram.com" target="_blank" class="fab fa-instagram"></a>
                        <a href="https://www.linkedin.com" target="_blank" class="fab fa-linkedin"></a>
                    </div>
                </div>

                <div class="box">
                    <h3>contacto</h3>
                    <p><i class="fas fa-phone"></i> +11456-7890</p>
                    <p><i class="fas fa-envelope"></i>
                        <a href="mailto:ApartHotel@gmail.com">ApartHotel@gmail.com</a>
                    </p>
                    <p><i class="fas fa-map"></i> Patagonia, Argentina</p>
                </div>

                <div class="box">
                    <h3>Información</h3>
                    <p>suscribite para recibir novedades</p>
                    <form>
                        <input type="email" placeholder="Ingrese su email..." class="email">
                        <button type="submit" class="btn">Suscribirse</button>
                    </form>
                </div>

            </div>

            <div class="credit">@creado por <span>Grupo4</span> | todos los derechos reservados!</div>

        </section>

    </footer>
    <!-- fin footer  -->

</body>

</html>